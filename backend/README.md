# Custom Model Context Protocol (MCP) Server

This directory contains the implementation for a custom Model Context Protocol (MCP) Server, designed to act as a specialized **Coding Assistant** for the `project-niv` workspace. The server exposes a suite of tools that allow an AI agent to perform file operations, interact with the Git repository, and conduct basic code analysis.

## Architecture

The server is built using Node.js and the `@modelcontextprotocol/sdk`. It operates as a standard MCP server, communicating over `stdio` (standard input/output). This architecture is ideal for integrating specialized capabilities into an AI workflow, allowing the agent to execute complex, workspace-aware tasks securely and reliably.

## Features and Toolset

The server exposes the following custom tools, which are available to any connected MCP client (e.g., an AI agent):

| Tool Name | Description | Input Parameters |
| :--- | :--- | :--- |
| `read_file` | Reads the contents of a file relative to the workspace root. | `filepath` (string) |
| `write_file` | Writes or updates a file with the specified content. | `filepath` (string), `content` (string) |
| `list_directory` | Lists files and directories in a given path. | `dirpath` (string, optional) |
| `search_files` | Searches for text patterns in files using `grep`. | `pattern` (string), `file_pattern` (string, optional) |
| `git_status` | Retrieves the current status of the Git repository. | None |
| `git_diff` | Shows the Git difference for staged or unstaged changes. | `staged` (boolean, optional), `filepath` (string, optional) |
| `git_commit` | Creates a Git commit with a specified message. | `message` (string), `add_all` (boolean, optional) |
| `git_log` | Shows recent Git commit history. | `limit` (number, optional) |
| `run_command` | Executes an arbitrary shell command within the workspace. **Use with caution.** | `command` (string) |
| `analyze_code` | Provides basic structural analysis of a code file (e.g., line count, functions, imports). | `filepath` (string) |
| `create_file_structure` | Creates multiple files and directories based on a structured object input. | `structure` (object) |

## Setup and Installation

To set up the MCP server, follow these steps:

1.  **Navigate to the backend directory:**
    ```bash
    cd backend
    ```

2.  **Install Node.js dependencies:**
    The server requires the `@modelcontextprotocol/sdk` package. Use pnpm to install the dependencies defined in `package.json`:
    ```bash
    pnpm install
    ```

## Usage and Testing

The server is designed to be run via an MCP client that communicates over standard I/O streams.

### Running the Server

The primary way to run the server is to pipe its output to an MCP client. This example uses the `manus-mcp-cli` tool to test the server's functionality:

```bash
node mcp-server.js | manus-mcp-cli tool list --server stdio
```

A successful execution will output the JSON representation of the tools listed in the **Features and Toolset** section, confirming that the server is operational and correctly communicating via the Model Context Protocol.

### Example: Calling a Tool

To test a specific tool, you can use the `tool call` command. For instance, to read the contents of the `README.md` file itself:

```bash
node mcp-server.js | manus-mcp-cli tool call read_file --server stdio --args '{"filepath": "README.md"}'
```

This command will instruct the server to execute the `read_file` tool with the argument `README.md`, and the output will be the file's content.

***

*Documentation generated by Manus AI.*
